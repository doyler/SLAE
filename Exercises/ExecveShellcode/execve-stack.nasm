; Filename: execve-stack.nasm
; Author: Ray Doyle
; Website: https://www.doyler.net
;
; Purpose: Execute /bin/bash via the stack

global _start

section .text

_start:
    ; Zero out the EAX register
    xor eax, eax
    
    ; Push 0x00000000 onto the stack
    push eax

    ; Push "////bin/bash" onto the stack (reverse order for endianness)
    push 0x68736162
    push 0x2f6e6962
    push 0x2f2f2f2f

    ; Load the "////bin/bash" null-terminated string into EBX
    mov ebx, esp

    ; Push 0x00000000 onto the stack (again)
    push eax

    ; Load 0x00000000 into EDX (envp for sys_execve)
    mov edx, esp

    ; Push EBX (the location of "////bin/bash") onto the stack
    push ebx

    ; Load the (address of ////bin/bash, 0x00000000) into ECX (argv for sys_execve)
    mov ecx, esp

    ; Load 11 into EAX (sys_execve syscall #)
    mov al, 0xb

    ; Execute the sys_execve syscall
    int 0x80